<Publish>
	<!--Id must be set in order to update existing mod. it is not required for publishing mod for the first time-->
	<ModId Value="117161" />
	<!--Name of the mod to display to players-->
	<DisplayName Value="Citizen Entity Cleaner" />
	<!--Short description of the mod-->
	<ShortDescription Value="Cleans up abandoned Citizen entities to fix corrupted cities and reduce simulation bloat." />
	<!--Long description of the mod. Single line or multi line. Supports minimal markdown subset-->
	<!--LongDescription Value="Some saves might have many abandoned Citizen entities leaving behind households, vehicles, and other entities while also decreasing performance. This mod provides a hack to manually clean those up." /-->
	<LongDescription>
		# Citizen Entity Cleaner

		## ⚠️ **[WARNING]** ⚠️
		**DO THIS FIRST: BACK UP YOUR SAVE.**
		**This mod touches sensitive game components and is a work-around. Use at your own risk.**

		## Problem

		Over time in some saves, Citizen and Household entities accumulate to extremely large numbers in Cities Skylines 2, far exceeding your actual population. Some users don't have this bug, but others could have millions of corrupted entities.

		## Performance Impact

		This entity bloat causes several issues:

		- **Significant performance drops** due to massive numbers of HouseholdFindSystem pathfinding queries
		- **Citizens stuck** at leisure or shopping destinations, never leaving under any circumstance
		- **Abandoned Cars** permanently occupying parking spots, never being used again
		- **General performance degradation** across querying systems

		ℹ️ **Mod Options**
		- Include **corrupt citizens** in cleanup (optional ✅)
		- Include **commuters** in cleanup (optional ✅)
		- Include **homeless** in cleanup (optional ✅)
		- Include **moving-away** (that have no rent) in cleanup (optional ✅)

		ℹ️ **This Mod may also:**
		- Delete "Pending" citizens that may be buffered for relocation
		- Cause momentary drops in population demand
		- Have other long-term consequences not fully understood
		- Safe to remove anytime

		ℹ️ **Usage**
		1. **\[Backup] your save file first!**
		2. Load the city, then open **Options → Citizen Entity Cleaner**.
		3. Click \[Refresh Counts] to see current statistics.
		4. Select checkbox ✅ options to include with the cleanup.
		5. Click \[Cleanup Citizens] to clean up entities.

		**Note**
		This mod does **not** run automatically; it only runs when you click \[Cleanup Citizens].
		Revert to the original saved city if you see unexpected behavior.

		## What This Mod Does

		- Everything is optional, pick and choose which items to remove (corrupt citizens, commuters, homeless).
		- For Corrupt Citizens: the mod finds households missing "PropertyRenter" that still list members.
		- Marks these citizen entities for deletion in chunked batches.
		- The base game then naturally cleans up remaining references (households, vehicles, student/patient references, and anything else afterwards).
		- This is a simple mod that doesn't conflict with other mods or overwrite vanilla code/systems, so it is relatively safe in that regard.

		## What is causing the issue?

		Not sure. It could be another mod or something introduced in a more recent patch. It seems somewhat related to the homeless and leisure bug fixes with the last two patches, so it may be an unintended bug introduced that only is really noticeable after long periods of simulation time. It's possible using Better Bulldozer on any citizens that are homeless can also put them into this state, making the problem worse. It could also be caused by unreachable, manually plopped buildings.

		## Feedback / Bug Report:
		* Go to Citizen Entity Cleaner channel on **Cities: Skylines Modding Discord**
		* https://discord.com/channels/1024242828114673724/1402078697120469064

		## Credits
		- phillycheese - mod author
		- yenyang - feedback, coop development
		- Konsi - testing, feedback
		- krzychu124 - testing, feedback
		- Honu - testing, feedback, logo, PR/coop development


	</LongDescription>
	<!--Thumbnail-->
	<Thumbnail Value="Properties/Thumbnail.png" />
	<!--Screenshot, can be set multiple times-->
	<Screenshot Value="Properties/Screenshots/10-CEC-thumbnail.png" />
	<Screenshot Value="Properties/Screenshots/20-Before.jpg" />
	<Screenshot Value="Properties/Screenshots/30-After.jpg" />
	
	<!--Tag, can be set multiple times-->
	<Tag Value="Code Mod" />
	<!--Link to the forum post where the mod can be discussed-->
	<ForumLink Value="" />
	 
	<!--Version of the mod-->
	<ModVersion Value="1.5.0" />
	 
	<!--Recommended version of the base game to use the mod-->
	<GameVersion Value="1.3.*" />
	<!--Dependency for the mod, can be set multiple times-->
	<Dependency Id="" />
	<!--Required DLC, can be set multiple times. Supported values are "Landmark Buildings", "San Fransisco Set", "Beach Properties", "Urban Promenades", "Modern Architecture"-->
	<RequiredDLC Value="" />
	 
<!--Change log for new version. Single line or multi line. Supports minimal markdown subset-->
<ChangeLog>
- Corrupt citizens are now "optional" checkbox to remove (not forced)
- **New:** Option to remove moving-away citizens (that have no PropertyRenter component)
- Option to remove Homeless or Commuters still available
- More accurate homeless/commuter handling via Household level checks
- **Fix:** Homeless detection now works even if they are in vehicles (transport-agnostic). previously only worked if they were walking.
- Tourists are now excluded explicitly
- UI updates and refactor: basic language support (EN, FR, ES, DE, IT)
</ChangeLog>

	<!--External link, can be set multiple times. supported types are "discord", "github", "youtube", "twitch", "x", "paypal", "patreon", "buymeacoffee", "kofi", "crowdin", "gitlab", "gofundme"-->
	<ExternalLink Type="github" Url="https://github.com/phillycheeze/CitizenEntityCleaner" />
	<ExternalLink Type="discord" Url="https://discord.com/channels/1024242828114673724/1402078697120469064" />
</Publish>

